
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Mario R. Melchiori">
      
      
        <link rel="canonical" href="https://mrmelchi.github.io/Python_Practico/04_Classes_objects/02_Inheritance/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>02_Inheritance - Python Practico</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#42-herencia" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Python Practico" class="md-header__button md-logo" aria-label="Python Practico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Python Practico
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              02_Inheritance
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Python Practico" class="md-nav__button md-logo" aria-label="Python Practico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Python Practico
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extencion" class="md-nav__link">
    <span class="md-ellipsis">
      Extención
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejemplo" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agrega-un-nuevo-metodo" class="md-nav__link">
    <span class="md-ellipsis">
      Agrega un nuevo método
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redefinicion-de-un-metodo-existente" class="md-nav__link">
    <span class="md-ellipsis">
      Redefinición de un método existente
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sobreescritura" class="md-nav__link">
    <span class="md-ellipsis">
      Sobreescritura
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#__init__-y-herencia" class="md-nav__link">
    <span class="md-ellipsis">
      __init__ y herencia
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uso-de-herencia" class="md-nav__link">
    <span class="md-ellipsis">
      Uso de herencia
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relacion-es-una" class="md-nav__link">
    <span class="md-ellipsis">
      Relación "es una"
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clase-base-object" class="md-nav__link">
    <span class="md-ellipsis">
      Clase base object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#herencia-multiple" class="md-nav__link">
    <span class="md-ellipsis">
      Herencia múltiple
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicios
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ejercicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-45-un-problema-de-extensibilidad" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 4.5: Un problema de extensibilidad
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-46-uso-de-la-herencia-para-producir-resultados-diferentes" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 4.6: Uso de la herencia para producir resultados diferentes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-47-polimorfismo-en-accion" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 4.7: Polimorfismo en acción
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-48-uniendo-todo" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 4.8: Uniendo todo
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discusion" class="md-nav__link">
    <span class="md-ellipsis">
      Discusión
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p><a href="../../Contents/">Contenido</a> | <a href="../01_Class/">Anterior (4.1 Clases)</a> | <a href="../03_Special_methods/">Próximo (4.3 Métodos especiales)</a></p>
<h1 id="42-herencia">4.2 Herencia</h1>
<p>La herencia es una herramienta que se utiliza habitualmente para escribir programas extensibles. Esta sección explora esa idea.</p>
<h2 id="introduccion">Introducción</h2>
<p>La herencia se utiliza para especializar objetos existentes:</p>
<pre><code class="language-python">class Parent:
...

class Child(Parent):
...
</code></pre>
<p>La nueva clase <code>Child</code> se denomina clase derivada o subclase. La clase <code>Parent</code> se conoce como clase base o superclase. <code>Parent</code> se especifica en <code>()</code> después del nombre de la clase, <code>class Child(Parent):</code>.</p>
<h2 id="extencion">Extención</h2>
<p>Con la herencia, tomas una clase existente y:</p>
<ul>
<li>Agregas nuevos métodos</li>
<li>Redefines algunos de los métodos existentes</li>
<li>Agregas nuevos atributos a las instancias</li>
</ul>
<p>Al final, <strong>extiendes el código existente</strong>.</p>
<h2 id="ejemplo">Ejemplo</h2>
<p>Supón que esta es tu clase inicial:</p>
<pre><code class="language-python">class Stock:
    def __init__(self, name, shares, price):
        self.name = name
        self.shares = shares
        self.price = price

    def cost(self):
        return self.shares * self.price

    def sell(self, nshares):
        self.shares -= nshares
</code></pre>
<p>Puedes cambiar cualquier parte de esto mediante la herencia.</p>
<h2 id="agrega-un-nuevo-metodo">Agrega un nuevo método</h2>
<pre><code class="language-python">class MyStock(Stock):
    def panic(self):
        self.sell(self.shares)
</code></pre>
<p>Ejemplo de uso.</p>
<pre><code class="language-python">&gt;&gt;&gt; s = MyStock('GOOG', 100, 490.1)
&gt;&gt;&gt; s.sell(25)
&gt;&gt;&gt; s.shares
75
&gt;&gt;&gt; s.panic()
&gt;&gt;&gt; s.shares
0
&gt;&gt;&gt;
</code></pre>
<h2 id="redefinicion-de-un-metodo-existente">Redefinición de un método existente</h2>
<pre><code class="language-python">class MyStock(Stock):
    def cost(self):
        return 1.25 * self.shares * self.price
</code></pre>
<p>Ejemplo de uso.</p>
<pre><code class="language-python">&gt;&gt;&gt; s = MyStock('GOOG', 100, 490.1)
&gt;&gt;&gt; s.cost()
61262.5
&gt;&gt;&gt;
</code></pre>
<p>El nuevo método reemplaza al anterior. Los otros métodos no se ven afectados. Es fantástico.</p>
<h2 id="sobreescritura">Sobreescritura</h2>
<p>A veces, una clase extiende un método existente, pero desea utilizar la implementación original dentro de la redefinición. Para ello, utilice <code>super()</code>:</p>
<pre><code class="language-python">class Stock:
    ...
    def cost(self):
        return self.shares * self.price
    ...

class MyStock(Stock):
    def cost(self):
    # Verifique la llamada a `super`
        actual_cost = super().cost()
        return 1.25 * actual_cost
</code></pre>
<p>Use <code>super()</code> para llamar a la versión anterior.</p>
<p><em>Precaución: En Python 2, la sintaxis era más detallada.</em></p>
<pre><code class="language-python">actual_cost = super(MyStock, self).cost()
</code></pre>
<h2 id="__init__-y-herencia"><code>__init__</code> y herencia</h2>
<p>Si se redefine <code>__init__</code>, es esencial inicializar el padre.</p>
<pre><code class="language-python">class Stock:
    def __init__(self, name, shares, price):
        self.name = name
        self.shares = shares
        self.price = price

class MyStock(Stock):
    def __init__(self, name, shares, price, factor):
    # Verifica la llamada a `super` y `__init__`
        super().__init__(name, shares, price)
        self.factor = factor

    def cost(self):
        return self.factor * super().cost()
</code></pre>
<p>Debes llamar al método <code>__init__()</code> en <code>super</code>, que es la forma de llamar a la versión anterior como se mostró anteriormente.</p>
<h2 id="uso-de-herencia">Uso de herencia</h2>
<p>La herencia se usa a veces para organizar objetos relacionados.</p>
<pre><code class="language-python">class Shape:
...

class Circle(Shape):
...

class Rectangle(Shape):
...
</code></pre>
<p>Piensa en una jerarquía lógica o taxonomía. Sin embargo, un uso más común (y práctico) está relacionado con la creación de código reutilizable o extensible. Por ejemplo, un marco de trabajo puede definir una clase base y darte instrucciones para personalizarla.</p>
<pre><code class="language-python">class CustomHandler(TCPHandler):
    def handle_request(self):
    ...
    # Procesamiento personalizado
</code></pre>
<p>La clase base contiene código de propósito general. Tu clase hereda y personaliza partes específicas.</p>
<h2 id="relacion-es-una">Relación "es una"</h2>
<p>La herencia establece una relación de tipos.</p>
<pre><code class="language-python">class Shape:
...

class Circle(Shape):
...
</code></pre>
<p>Comprueba si hay una instancia de objeto.</p>
<pre><code class="language-python">&gt;&gt;&gt; c = Circle(4.0)
&gt;&gt;&gt; isinstance(c, Shape)
True
&gt;&gt;&gt;
</code></pre>
<p><em>Importante: idealmente, cualquier código que haya funcionado con instancias de la clase padre también funcionará con instancias de la clase hija.</em></p>
<h2 id="clase-base-object">Clase base <code>object</code></h2>
<p>Si una clase no tiene padre, a veces verás que <code>object</code> se usa como base.</p>
<pre><code class="language-python">class Shape(object):
...
</code></pre>
<p><code>object</code> es el padre de todos los objetos en Python.</p>
<p>*Nota: técnicamente no es obligatorio, pero a menudo lo ves especificado como un remanente de su uso obligatorio en Python 2. Si se omite, la clase aún hereda implícitamente de <code>object</code>.</p>
<h2 id="herencia-multiple">Herencia múltiple</h2>
<p>Puedes heredar de varias clases especificándolas en la definición de la clase.</p>
<pre><code class="language-python">class Mother:
...

class Father:
...

class Child(Mother, Father):
...
</code></pre>
<p>La clase <code>Child</code> hereda características de ambos padres. Hay algunos detalles un poco complicados. No lo hagas a menos que sepas lo que estás haciendo. Se dará más información en la siguiente sección, pero no vamos a utilizar más la herencia múltiple en este curso.</p>
<h2 id="ejercicios">Ejercicios</h2>
<p>Un uso importante de la herencia es escribir código que se puede ampliar o personalizar de varias maneras, especialmente en bibliotecas o marcos. Para ilustrarlo, considere la función <code>print_report()</code> en su programa <code>report.py</code>. Debería verse algo como esto:</p>
<pre><code class="language-python">def print_report(reportdata):
    '''
    Imprima una tabla con un formato agradable a partir de una lista de         tuplas (name, shares, price, change).
    '''
    headers = ('Name','Shares','Price','Change')
    print('%10s %10s %10s %10s' % headers)
    print(('-'*10 + ' ')*len(headers))
    for row in reportdata:
        print('%10s %10d %10.2f %10.2f' % row)
</code></pre>
<p>Cuando ejecute su programa de informe, debería obtener un resultado como este:</p>
<pre><code>&gt;&gt;&gt; import report
&gt;&gt;&gt; report.portfolio_report('Data/portfolio.csv', 'Data/prices.csv')
      Name     Shares      Price     Change
---------- ---------- ---------- ----------
        AA        100       9.22     -22.98
       IBM         50     106.28      15.18
       CAT        150      35.46     -47.98
      MSFT        200      20.89     -30.34
        GE         95      13.48     -26.89
      MSFT         50      20.89     -44.21
       IBM        100     106.28      35.84
</code></pre>
<h3 id="ejercicio-45-un-problema-de-extensibilidad">Ejercicio 4.5: Un problema de extensibilidad</h3>
<p>Supongamos que desea modificar la función <code>print_report()</code> para que admita una variedad de formatos de salida diferentes, como texto sin formato, HTML, CSV o XML. Para ello, podría intentar escribir una función gigantesca que hiciera todo. Sin embargo, hacerlo probablemente conduciría a un desastre imposible de mantener. En cambio, esta es una oportunidad perfecta para utilizar la herencia.</p>
<p>Para comenzar, concéntrese en los pasos que intervienen en la creación de una tabla. En la parte superior de la tabla hay un conjunto de encabezados de tabla. Después de eso, aparecen las filas de datos de la tabla. Tomemos esos pasos y pongámoslos en su propia clase. Cree un archivo llamado <code>tableformat.py</code> y defina la siguiente clase:</p>
<pre><code class="language-python"># tableformat.py

class TableFormatter:
    def headers(self, headers):
    '''
    Emite los encabezados de la tabla.
    '''
    raise NotImplementedError()

    def row(self, rowdata):
    '''
    Emite una sola fila de datos de la tabla.
    '''
    raise NotImplementedError()
</code></pre>
<p>Esta clase no hace nada, pero sirve como una especie de especificación de diseño para clases adicionales que se definirán en breve. A una clase como esta a veces se la llama "clase base abstracta".</p>
<p>Modifique la función <code>print_report()</code> para que acepte un objeto <code>TableFormatter</code> como entrada e invoque métodos en él para producir la salida. Por ejemplo, de esta manera:</p>
<pre><code class="language-python"># report.py
...

def print_report(reportdata, formatter):
    '''
    Imprime una tabla con un formato agradable a partir de una lista de tuplas (name, shares, price, change).
    '''
    formatter.headings(['Name','Shares','Price','Change'])
    for name, shares, price, change in reportdata:
        rowdata = [ name, str(shares), f'{price:0.2f}', f'{change:0.2f}' ]
        formatter.row(rowdata)
</code></pre>
<p>Dado que agregaste un argumento a print_report(), también necesitarás modificar la función portfolio_report()<code>. Cámbielo para que cree un</code>TableFormatter` como este:</p>
<pre><code class="language-python"># report.py

import tableformat

...
def portfolio_report(portfoliofile, pricefile):
    '''
    Cree un informe de acciones a partir de los archivos de datos de cartera y precios.
    '''
    # Leer archivos de datos
    portfolio = read_portfolio(portfoliofile)
    prices = read_prices(pricefile)

    # Crear los datos del informe
    report = make_report_data(portfolio, prices)

    # Imprimirlo
    formatter = tableformat.TableFormatter()
    print_report(report, formatter)
</code></pre>
<p>Ejecutar este nuevo código:</p>
<pre><code class="language-python">&gt;&gt;&gt; ================================== RESTART ==================================
&gt;&gt;&gt; import report
&gt;&gt;&gt; report.portfolio_report('Data/portfolio.csv', 'Data/prices.csv')
... se bloquea ...
</code></pre>
<p>Debería bloquearse inmediatamente con una excepción <code>NotImplementedError</code>. No es muy interesante, pero es exactamente lo que esperábamos. Continúe con la siguiente parte.</p>
<h3 id="ejercicio-46-uso-de-la-herencia-para-producir-resultados-diferentes">Ejercicio 4.6: Uso de la herencia para producir resultados diferentes</h3>
<p>La clase <code>TableFormatter</code> que definió en la parte (a) está pensada para extenderse mediante herencia. De hecho, esa es la idea. Para ilustrarlo, defina una clase <code>TextTableFormatter</code> de la siguiente manera:</p>
<pre><code class="language-python"># tableformat.py
...
class TextTableFormatter(TableFormatter):
    '''
    Emite una tabla en formato de texto simple
    '''
    def headers(self, headers):
        for h in headers:
              print(f'{h:&gt;10s}', end=' ')
        print()
        print(('-'*10 + ' ')*len(headers))

    def row(self, rowdata):
        for d in rowdata:
            print(f'{d:&gt;10s}', end=' ')
        print()
</code></pre>
<p>Modifique la función <code>portfolio_report()</code> de esta manera y pruébela:</p>
<pre><code class="language-python"># report.py
...
def portfolio_report(portfoliofile, pricefile):
    '''
    Genere un informe de acciones a partir de los archivos de datos de cartera y precios.
    '''
    # Leer archivos de datos
    portfolio = read_portfolio(portfoliofile)
    prices = read_prices(pricefile)

    # Crear los datos del informe
    report = make_report_data(portfolio, prices)

    # Imprimirlo
    formatter = tableformat.TextTableFormatter()
    print_report(report, formatter)
</code></pre>
<p>Esto debería producir el mismo resultado que antes:</p>
<pre><code class="language-python">&gt;&gt;&gt; ================================ RESTART ================================
&gt;&gt;&gt; import report
&gt;&gt;&gt; report.portfolio_report('Data/portfolio.csv', 'Data/prices.csv')
      Name     Shares      Price     Change
---------- ---------- ---------- ----------
        AA        100       9.22     -22.98
       IBM         50     106.28      15.18
       CAT        150      35.46     -47.98
      MSFT        200      20.89     -30.34
        GE         95      13.48     -26.89
      MSFT         50      20.89     -44.21
       IBM        100     106.28      35.84
&gt;&gt;&gt;
</code></pre>
<p>Sin embargo, cambiemos la salida por otra cosa. Definamos una nueva clase <code>CSVTableFormatter</code> que produzca una salida en formato CSV:</p>
<pre><code class="language-python"># tableformat.py
...
class CSVTableFormatter(TableFormatter):
    '''
    Datos de cartera de salida en formato CSV.
    '''
    def headers(self, headers):
    print(','.join(headers))

    def row(self, rowdata):
    print(','.join(rowdata))
</code></pre>
<p>Modifique su programa principal de la siguiente manera:</p>
<pre><code class="language-python">def portfolio_report(portfoliofile, pricefile):
    '''
    Genere un informe de acciones a partir de los archivos de datos de cartera y precios. 
    '''
    # Leer archivos de datos
    portfolio = read_portfolio(portfoliofile)
    prices = read_prices(pricefile)

    # Crear los datos del informe
    report = make_report_data(portfolio, prices)

    # Imprimirlo
    formatter = tableformat.CSVTableFormatter()
    print_report(report, formatter)
</code></pre>
<p>Ahora debería ver una salida CSV como esta:</p>
<pre><code class="language-python">&gt;&gt;&gt; ================================ RESTART ================================
&gt;&gt;&gt; import report
&gt;&gt;&gt; report.portfolio_report('Data/portfolio.csv', 'Data/prices.csv')
Name,Shares,Price,Change
AA,100,9.22,-22.98
IBM,50,106.28,15.18
CAT,150,35.46,-47.98
MSFT,200,20.89,-30.34
GE,95,13.48,-26.89
MSFT,50,20.89,-44.21
IBM,100,106.28,35.84
</code></pre>
<p>Usando una idea similar, defina una clase <code>HTMLTableFormatter</code> que produzca una tabla con lo siguiente salida:</p>
<pre><code>&lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Shares&lt;/th&gt;&lt;th&gt;Price&lt;/th&gt;&lt;th&gt;Change&lt;/th&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;AA&lt;/td&gt;&lt;td&gt;100&lt;/td&gt;&lt;td&gt;9.22&lt;/td&gt;&lt;td&gt;-22.98&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;IBM&lt;/td&gt;&lt;td&gt;50&lt;/td&gt;&lt;td&gt;106.28&lt;/td&gt;&lt;td&gt;15.18&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;CAT&lt;/td&gt;&lt;td&gt;150&lt;/td&gt;&lt;td&gt;35.46&lt;/td&gt;&lt;td&gt;-47.98&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;MSFT&lt;/td&gt;&lt;td&gt;200&lt;/td&gt;&lt;td&gt;20.89&lt;/td&gt;&lt;td&gt;-30.34&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;GE&lt;/td&gt;&lt;td&gt;95&lt;/td&gt;&lt;td&gt;13.48&lt;/td&gt;&lt;td&gt;-26.89&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;MSFT&lt;/td&gt;&lt;td&gt;50&lt;/td&gt;&lt;td&gt;20.89&lt;/td&gt;&lt;td&gt;-44.21&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;IBM&lt;/td&gt;&lt;td&gt;100&lt;/td&gt;&lt;td&gt;106.28&lt;/td&gt;&lt;td&gt;35.84&lt;/td&gt;&lt;/tr&gt;
</code></pre>
<p>Pruebe Su código modificando el programa principal para crear un objeto <code>HTMLTableFormatter</code> en lugar de un objeto <code>CSVTableFormatter</code>.</p>
<h3 id="ejercicio-47-polimorfismo-en-accion">Ejercicio 4.7: Polimorfismo en acción</h3>
<p>Una característica importante de la programación orientada a objetos es que puede conectar un objeto a un programa y funcionará sin tener que cambiar nada del código existente. Por ejemplo, si escribió un programa que esperaba utilizar un objeto <code>TableFormatter</code>, funcionaría sin importar qué tipo de <code>TableFormatter</code> le haya asignado. Este comportamiento a veces se denomina "polimorfismo".</p>
<p>Un problema potencial es averiguar cómo permitir que un usuario elija el formateador que desea. El uso directo de los nombres de clase como <code>TextTableFormatter</code> suele ser molesto. Por lo tanto, puede considerar un enfoque simplificado. Tal vez puedas incorporar una declaración <code>if-</code> en el código de esta manera:</p>
<pre><code class="language-python">def portfolio_report(portfoliofile, pricefile, fmt='txt'):
    '''
    Crea un informe de acciones a partir de los archivos de datos de cartera y precios. '''
    # Leer archivos de datos
    portfolio = read_portfolio(portfoliofile)
    prices = read_prices(pricefile)

    # Crear los datos del informe
    report = make_report_data(portfolio, prices)

    # Imprimirlo
    if fmt == 'txt':
        formatter = tableformat.TextTableFormatter()
        elif fmt == 'csv':
        formatter = tableformat.CSVTableFormatter()
    elif fmt == 'html':
        formatter = tableformat.HTMLTableFormatter()
    else:
        raise RuntimeError(f'Unknown format {fmt}')
    print_report(report, formatter)
</code></pre>
<p>En este código, el usuario especifica un nombre simplificado como <code>'txt'</code> o <code>'csv'</code> para elegir un formato. Sin embargo, ¿es la mejor idea poner una declaración <code>si</code> grande en la función <code>portfolio_report()</code>? Tal vez sea mejor mover ese código a una función de propósito general en otro lugar.</p>
<p>En el archivo <code>tableformat.py</code>, agregue una función <code>create_formatter(name)</code> que permita a un usuario crear un formateador dado un nombre de salida como <code>'txt'</code>, <code>'csv'</code> o <code>'html'</code>. Modifique <code>portfolio_report()</code> para que se vea así:</p>
<pre><code class="language-python">def portfolio_report(portfoliofile, pricefile, fmt='txt'):
    '''
    Cree un informe de acciones dados los archivos de datos de cartera y precios.
    '''
    # Leer archivos de datos
    portfolio = read_portfolio(portfoliofile)
    prices = read_prices(pricefile)

    # Crear los datos del informe
    report = make_report_data(portfolio, prices)

    # Imprimirlo
    formatter = tableformat.create_formatter(fmt)
    print_report(report, formatter)
</code></pre>
<p>Intente llamar a la función con diferentes formatos para asegurarse de que esté funcionando.</p>
<h3 id="ejercicio-48-uniendo-todo">Ejercicio 4.8: Uniendo todo</h3>
<p>Modifique el programa <code>report.py</code> para que la función <code>portfolio_report()</code> acepte un argumento opcional que especifique el formato de salida. Por ejemplo:</p>
<pre><code class="language-python">&gt;&gt;&gt; report.portfolio_report('Data/portfolio.csv', 'Data/prices.csv', 'txt')
      Name     Shares      Price     Change
---------- ---------- ---------- ----------
        AA        100       9.22     -22.98
       IBM         50     106.28      15.18
       CAT        150      35.46     -47.98
      MSFT        200      20.89     -30.34
        GE         95      13.48     -26.89
      MSFT         50      20.89     -44.21
       IBM        100     106.28      35.84
&gt;&gt;&gt;
</code></pre>
<p>Modifique el programa principal para que se pueda proporcionar un formato en la línea de comandos:</p>
<pre><code class="language-bash">bash $ python3 report.py Data/portfolio.csv Data/prices.csv csv
Name,Shares,Price,Change
AA,100,9.22,-22.98
IBM,50,106.28,15.18
CAT,150,35.46,-47.98
MSFT,200,20.89,-30.34
GE,95,13.48,-26.89
MSFT,50,20.89,-44.21
IBM,100,106.28,35.84
bash $
</code></pre>
<h2 id="discusion">Discusión</h2>
<p>Escribir código extensible es uno de los usos más comunes de la herencia en bibliotecas y marcos. Por ejemplo, un marco puede indicarle que defina su propio objeto que hereda de una clase base proporcionada. Luego se le indica que complete varios métodos que implementan varios fragmentos de funcionalidad.</p>
<p>Otro concepto un poco más profundo es la idea de "ser dueño de sus abstracciones". En los ejercicios, definimos <em>nuestra propia clase</em> para formatear una tabla. Puede mirar su código y decirse a sí mismo "¡Debería usar una biblioteca de formato o algo que alguien más ya haya creado!" No, debe usar TANTO su clase como una biblioteca. Usar su propia clase promueve el acoplamiento estrecho (<em>loose coupling</em>) [<a href="https://en.wikipedia.org/wiki/Loose_coupling">https://en.wikipedia.org/wiki/Loose_coupling</a>] es más independiente y es más flexible. Mientras su aplicación use la interfaz de programación de su clase, puede cambiar la implementación interna para que funcione de la forma que desee. Puede escribir código totalmente personalizado. Puede usar el paquete de terceros de alguien. Puede cambiar un paquete de terceros por un paquete diferente cuando encuentre uno mejor. No importa: nada del código de su aplicación se romperá mientras conserve la interfaz. Esa es una idea poderosa y es una de las razones por las que podría considerar la herencia para algo como esto.</p>
<p>Dicho esto, diseñar programas orientados a objetos puede ser extremadamente difícil. Para obtener más información, probablemente debería buscar libros sobre el tema de los patrones de diseño (aunque comprender lo que sucedió en este ejercicio lo llevará bastante lejos en términos de usar objetos de una manera práctica y útil).</p>
<p><a href="../../Contents/">Contenido</a> | <a href="../01_Class/">Anterior (4.1 Clases)</a> | <a href="../03_Special_methods/">Próximo (4.3 Métodos especiales)</a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>