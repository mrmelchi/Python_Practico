<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Mario R. Melchiori">
        <link rel="canonical" href="https://mrmelchi.github.io/Python_Practico/06_Generators/04_More_generators/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>04_More_generators - Python Practico</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Python Practico</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#64-mas-generadores" class="nav-link">6.4 Más generadores</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#expresiones-generadoras" class="nav-link">Expresiones generadoras</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#por-que-generadores" class="nav-link">Por qué generadores</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#modulo-itertools" class="nav-link">Módulo itertools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#ejercicios" class="nav-link">Ejercicios</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="../../Contents/">Contenido</a> | <a href="../03_Producers_consumers/">Anterior (6.3 Problemas y flujos de trabajo de productores y consumidores)</a> | <a href="../../07_Advanced_Topics/00_Overview/">Próximo (7. Algunos temas avanzados)</a></p>
<h1 id="64-mas-generadores">6.4 Más generadores</h1>
<p>Esta sección presenta algunos temas adicionales relacionados con los generadores, incluidas las expresiones de generador y el módulo <code>itertools</code>.</p>
<h2 id="expresiones-generadoras">Expresiones generadoras</h2>
<p>Una versión de generador de una lista por comprensión.</p>
<pre><code class="language-python">&gt;&gt;&gt; a = [1,2,3,4]
&gt;&gt;&gt; b = (2*x for x in a)
&gt;&gt;&gt; b
&lt;generator object at 0x58760&gt;
&gt;&gt;&gt; for i in b:
... print(i, end=' ')
...
2 4 6 8
&gt;&gt;&gt;
</code></pre>
<p>Diferencias con las listas por comprensión.</p>
<ul>
<li>No construye una lista.</li>
<li>El único propósito útil es la iteración.</li>
<li>Una vez consumido, no se puede reutilizar.</li>
</ul>
<p>Sintaxis general.</p>
<pre><code class="language-python">(&lt;expresión&gt; for i in s if &lt;condicional&gt;)
</code></pre>
<p>También puede servir como argumento de función.</p>
<pre><code class="language-python">sum(x*x for x in a)
</code></pre>
<p>Se puede aplicar a cualquier iterable.</p>
<pre><code class="language-python">&gt;&gt;&gt; a = [1,2,3,4]
&gt;&gt;&gt; b = (x*x for x in a)
&gt;&gt;&gt; c = (-x for x in b)
&gt;&gt;&gt; for i in c:
... print(i, end=' ')
...
-1 -4 -9 -16
&gt;&gt;&gt;
</code></pre>
<p>El uso principal de las expresiones de generador es en código que realiza algún cálculo en una secuencia, pero solo usa el resultado una vez. Por ejemplo, eliminar todos los comentarios de un archivo.</p>
<pre><code class="language-python">f = open('somefile.txt')
lines = (line for line in f if not line.startswith('#'))
for line in lines:
    ...
f.close()
</code></pre>
<p>Con los generadores, el código se ejecuta más rápido y usa menos memoria. Es como un filtro aplicado a una secuencia.</p>
<h2 id="por-que-generadores">Por qué generadores</h2>
<ul>
<li>Muchos problemas se expresan mucho más claramente en términos de iteración.</li>
<li>Recorrer una colección de elementos y realizar algún tipo de operación (buscar, reemplazar, modificar, etc.).</li>
<li>Las canalizaciones de procesamiento se pueden aplicar a una amplia gama de problemas de procesamiento de datos.</li>
<li>Mejor eficiencia de la memoria.</li>
<li>Solo se producen valores cuando es necesario.</li>
<li>Contraste con la construcción de listas gigantes.</li>
<li>Puede operar en datos en tiempo real.</li>
<li>Los generadores fomentan la reutilización de código.</li>
<li>Separa la <em>iteración</em> del código que utiliza la iteración.</li>
<li>Puede crear una caja de herramientas de funciones de iteración interesantes y <em>mezclar y combinar</em>.</li>
</ul>
<h2 id="modulo-itertools">Módulo <code>itertools</code></h2>
<p><code>itertools</code> es un módulo de biblioteca con varias funciones diseñadas para ayudar con los iteradores/generadores.</p>
<pre><code class="language-python">itertools.chain(s1,s2)
itertools.count(n)
itertools.cycle(s)
itertools.dropwhile(predicate, s)
itertools.groupby(s)
itertools.ifilter(predicate, s)
itertools.imap(function, s1, ... sN)
itertools.repeat(s, n)
itertools.tee(s, ncopies)
itertools.izip(s1, ... , sN)
</code></pre>
<p>Todas las funciones procesan datos de forma iterativa. Implementan varios tipos de patrones de interación.</p>
<p>Más información en el tutorial <a href="http://www.dabeaz.com/generators/">Generator Tricks for Systems Programmers</a> de PyCon '08.</p>
<h2 id="ejercicios">Ejercicios</h2>
<p>En los ejercicios anteriores, escribió un código que seguía las líneas que se escribían en un archivo de registro y las analizó en una secuencia de filas. Este ejercicio continúa basándose en eso. Asegúrese de que <code>Data/stocksim.py</code> todavía se esté ejecutando.</p>
<h3 id="ejercicio-613-expresiones-generadoras">Ejercicio 6.13: Expresiones generadoras</h3>
<p>Las expresiones generadoras son una versión generadora de una comprensión de lista. Por ejemplo:</p>
<pre><code class="language-python">&gt;&gt;&gt; nums = [1, 2, 3, 4, 5]
&gt;&gt;&gt; squares = (x*x for x in nums)
&gt;&gt;&gt; squares
&lt;generator object &lt;genexpr&gt; at 0x109207e60&gt;
&gt;&gt;&gt; for n in squares:
...     print(n)
...
1
4
9
16
25
</code></pre>
<p>A diferencia de una lista por comprensión, una expresión generadora solo se puede usar una vez. Por lo tanto, si intentas otro bucle for, no obtienes nada:</p>
<pre><code class="language-python">&gt;&gt;&gt; for n in squares:
...     print(n)
...
&gt;&gt;&gt;
</code></pre>
<h3 id="ejercicio-614-expresiones-generadoras-en-argumentos-de-funcion">Ejercicio 6.14: Expresiones generadoras en argumentos de función</h3>
<p>A veces, las expresiones generadoras se colocan en los argumentos de función. Parece un poco extraño al principio, pero prueba este experimento:</p>
<pre><code class="language-python">&gt;&gt;&gt; nums = [1,2,3,4,5]
&gt;&gt;&gt; sum([x*x for x in nums]) # Una comprensión de lista
55
&gt;&gt;&gt; sum(x*x for x in nums) # Una expresión generadora
55
&gt;&gt;&gt;
</code></pre>
<p>En el ejemplo anterior, la segunda versión que usa generadores utilizaría significativamente menos memoria si se manipulara una lista grande.</p>
<p>En tu archivo <code>portfolio.py</code>, realizaste algunos cálculos que involucraban comprensiones de lista. Intente reemplazarlas con expresiones generadoras.</p>
<h3 id="ejercicio-615-simplificacion-de-codigo">Ejercicio 6.15: Simplificación de código</h3>
<p>Las expresiones generadoras suelen ser un reemplazo útil para funciones generadoras pequeñas. Por ejemplo, en lugar de escribir una función como esta:</p>
<pre><code class="language-python">def filter_symbols(rows, names):
    for row in rows:
        if row['name'] in names:
            yield row
</code></pre>
<p>Podría escribir algo como esto:</p>
<pre><code class="language-python">rows = (row for row in rows if row['name'] in names)
</code></pre>
<p>Modifique el programa <code>ticker.py</code> para usar expresiones generadoras según corresponda.</p>
<p><a href="../../Contents/">Contenido</a> | <a href="../03_Producers_consumers/">Anterior (6.3 Problemas y flujos de trabajo de productores y consumidores)</a> | <a href="../../07_Advanced_Topics/00_Overview/">Próximo (7. Algunos temas avanzados)</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
