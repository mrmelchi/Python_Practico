
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Mario R. Melchiori">
      
      
        <link rel="canonical" href="https://mrmelchi.github.io/Python_Practico/06_Generators/04_More_generators/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>04_More_generators - Python Practico</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#64-mas-generadores" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Python Practico" class="md-header__button md-logo" aria-label="Python Practico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Python Practico
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              04_More_generators
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Python Practico" class="md-nav__button md-logo" aria-label="Python Practico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Python Practico
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#expresiones-generadoras" class="md-nav__link">
    <span class="md-ellipsis">
      Expresiones generadoras
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#por-que-generadores" class="md-nav__link">
    <span class="md-ellipsis">
      Por qué generadores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modulo-itertools" class="md-nav__link">
    <span class="md-ellipsis">
      Módulo itertools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicios
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ejercicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-613-expresiones-generadoras" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 6.13: Expresiones generadoras
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-614-expresiones-generadoras-en-argumentos-de-funcion" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 6.14: Expresiones generadoras en argumentos de función
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-615-simplificacion-de-codigo" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 6.15: Simplificación de código
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p><a href="../../Contents/">Contenido</a> | <a href="../03_Producers_consumers/">Anterior (6.3 Problemas y flujos de trabajo de productores y consumidores)</a> | <a href="../../07_Advanced_Topics/00_Overview/">Próximo (7. Algunos temas avanzados)</a></p>
<h1 id="64-mas-generadores">6.4 Más generadores</h1>
<p>Esta sección presenta algunos temas adicionales relacionados con los generadores, incluidas las expresiones de generador y el módulo <code>itertools</code>.</p>
<h2 id="expresiones-generadoras">Expresiones generadoras</h2>
<p>Una versión de generador de una lista por comprensión.</p>
<pre><code class="language-python">&gt;&gt;&gt; a = [1,2,3,4]
&gt;&gt;&gt; b = (2*x for x in a)
&gt;&gt;&gt; b
&lt;generator object at 0x58760&gt;
&gt;&gt;&gt; for i in b:
... print(i, end=' ')
...
2 4 6 8
&gt;&gt;&gt;
</code></pre>
<p>Diferencias con las listas por comprensión.</p>
<ul>
<li>No construye una lista.</li>
<li>El único propósito útil es la iteración.</li>
<li>Una vez consumido, no se puede reutilizar.</li>
</ul>
<p>Sintaxis general.</p>
<pre><code class="language-python">(&lt;expresión&gt; for i in s if &lt;condicional&gt;)
</code></pre>
<p>También puede servir como argumento de función.</p>
<pre><code class="language-python">sum(x*x for x in a)
</code></pre>
<p>Se puede aplicar a cualquier iterable.</p>
<pre><code class="language-python">&gt;&gt;&gt; a = [1,2,3,4]
&gt;&gt;&gt; b = (x*x for x in a)
&gt;&gt;&gt; c = (-x for x in b)
&gt;&gt;&gt; for i in c:
... print(i, end=' ')
...
-1 -4 -9 -16
&gt;&gt;&gt;
</code></pre>
<p>El uso principal de las expresiones de generador es en código que realiza algún cálculo en una secuencia, pero solo usa el resultado una vez. Por ejemplo, eliminar todos los comentarios de un archivo.</p>
<pre><code class="language-python">f = open('somefile.txt')
lines = (line for line in f if not line.startswith('#'))
for line in lines:
    ...
f.close()
</code></pre>
<p>Con los generadores, el código se ejecuta más rápido y usa menos memoria. Es como un filtro aplicado a una secuencia.</p>
<h2 id="por-que-generadores">Por qué generadores</h2>
<ul>
<li>Muchos problemas se expresan mucho más claramente en términos de iteración.</li>
<li>Recorrer una colección de elementos y realizar algún tipo de operación (buscar, reemplazar, modificar, etc.).</li>
<li>Las tuberias de procesamiento se pueden aplicar a una amplia gama de problemas de procesamiento de datos.</li>
<li>Mejor eficiencia de la memoria.</li>
<li>Solo se producen valores cuando es necesario.</li>
<li>Contrasta con la construcción de listas gigantes.</li>
<li>Puede operar en datos en tiempo real.</li>
<li>Los generadores fomentan la reutilización de código.</li>
<li>Separa la <em>iteración</em> del código que utiliza la iteración.</li>
<li>Puede crear una caja de herramientas de funciones de iteración interesantes y <em>mezclar y combinar</em>.</li>
</ul>
<h2 id="modulo-itertools">Módulo <code>itertools</code></h2>
<p><code>itertools</code> es un módulo de biblioteca con varias funciones diseñadas para ayudar con los iteradores/generadores.</p>
<pre><code class="language-python">itertools.chain(s1,s2)
itertools.count(n)
itertools.cycle(s)
itertools.dropwhile(predicate, s)
itertools.groupby(s)
itertools.ifilter(predicate, s)
itertools.imap(function, s1, ... sN)
itertools.repeat(s, n)
itertools.tee(s, ncopies)
itertools.izip(s1, ... , sN)
</code></pre>
<p>Todas las funciones procesan datos de forma iterativa. Implementan varios tipos de patrones de interación.</p>
<p>Más información en el tutorial <a href="http://www.dabeaz.com/generators/">Generator Tricks for Systems Programmers</a> de PyCon '08.</p>
<h2 id="ejercicios">Ejercicios</h2>
<p>En los ejercicios anteriores, escribió un código que seguía las líneas que se escribían en un archivo de registro y las analizó en una secuencia de filas. Este ejercicio continúa basándose en eso. Asegúrese de que <code>Data/stocksim.py</code> todavía se esté ejecutando.</p>
<h3 id="ejercicio-613-expresiones-generadoras">Ejercicio 6.13: Expresiones generadoras</h3>
<p>Las expresiones generadoras son una versión generadora de una comprensión de lista. Por ejemplo:</p>
<pre><code class="language-python">&gt;&gt;&gt; nums = [1, 2, 3, 4, 5]
&gt;&gt;&gt; squares = (x*x for x in nums)
&gt;&gt;&gt; squares
&lt;generator object &lt;genexpr&gt; at 0x109207e60&gt;
&gt;&gt;&gt; for n in squares:
...     print(n)
...
1
4
9
16
25
</code></pre>
<p>A diferencia de una lista por comprensión, una expresión generadora solo se puede usar una vez. Por lo tanto, si intentas otro bucle for, no obtienes nada:</p>
<pre><code class="language-python">&gt;&gt;&gt; for n in squares:
...     print(n)
...
&gt;&gt;&gt;
</code></pre>
<h3 id="ejercicio-614-expresiones-generadoras-en-argumentos-de-funcion">Ejercicio 6.14: Expresiones generadoras en argumentos de función</h3>
<p>A veces, las expresiones generadoras se colocan en los argumentos de función. Parece un poco extraño al principio, pero prueba este experimento:</p>
<pre><code class="language-python">&gt;&gt;&gt; nums = [1,2,3,4,5]
&gt;&gt;&gt; sum([x*x for x in nums]) # Una comprensión de lista
55
&gt;&gt;&gt; sum(x*x for x in nums) # Una expresión generadora
55
&gt;&gt;&gt;
</code></pre>
<p>En el ejemplo anterior, la segunda versión que usa generadores utilizaría significativamente menos memoria si se manipulara una lista grande.</p>
<p>En tu archivo <code>portfolio.py</code>, realizaste algunos cálculos que involucraban comprensiones de lista. Intente reemplazarlas con expresiones generadoras.</p>
<h3 id="ejercicio-615-simplificacion-de-codigo">Ejercicio 6.15: Simplificación de código</h3>
<p>Las expresiones generadoras suelen ser un reemplazo útil para funciones generadoras pequeñas. Por ejemplo, en lugar de escribir una función como esta:</p>
<pre><code class="language-python">def filter_symbols(rows, names):
    for row in rows:
        if row['name'] in names:
            yield row
</code></pre>
<p>Podría escribir algo como esto:</p>
<pre><code class="language-python">rows = (row for row in rows if row['name'] in names)
</code></pre>
<p>Modifique el programa <code>ticker.py</code> para usar expresiones generadoras según corresponda.</p>
<p><a href="../../Contents/">Contenido</a> | <a href="../03_Producers_consumers/">Anterior (6.3 Problemas y flujos de trabajo de productores y consumidores)</a> | <a href="../../07_Advanced_Topics/00_Overview/">Próximo (7. Algunos temas avanzados)</a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>