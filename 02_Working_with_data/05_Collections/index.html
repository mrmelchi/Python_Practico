
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Mario R. Melchiori">
      
      
        <link rel="canonical" href="https://mrmelchi.github.io/Python_Practico/02_Working_with_data/05_Collections/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>05_Collections - Python Practico</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#25-modulo-collections" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Python Practico" class="md-header__button md-logo" aria-label="Python Practico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Python Practico
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              05_Collections
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Python Practico" class="md-nav__button md-logo" aria-label="Python Practico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Python Practico
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ejemplo-contar-cosas" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo: Contar cosas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contadores" class="md-nav__link">
    <span class="md-ellipsis">
      Contadores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejemplo-asignaciones-de-uno-a-muchos" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo: Asignaciones de uno a muchos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejemplo-mantener-un-historial" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo: Mantener un historial
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicios
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ejercicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-218-tabulacion-con-contadores" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 2.18: Tabulación con contadores
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comentario-modulo-collections" class="md-nav__link">
    <span class="md-ellipsis">
      Comentario: módulo Collections
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p><a href="../../Contents/">Contenido</a> | <a href="../04_Sequences/">Anterior (2.4
Secuencias)</a> | <a href="../06_List_comprehension/">Próximo (2.6 Listas por
comprensión)</a></p>
<h1 id="25-modulo-collections">2.5 Módulo <code>collections</code></h1>
<p>El módulo <code>collections</code> proporciona una serie de objetos útiles para el
manejo de datos. En esta parte se presentan brevemente algunas de estas
características.</p>
<h2 id="ejemplo-contar-cosas">Ejemplo: Contar cosas</h2>
<p>Digamos que desea tabular el total de acciones de cada acción.</p>
<pre><code class="language-python">portfolio = [
    ('GOOG', 100, 490.1),
    ('IBM', 50, 91.1),
    ('CAT', 150, 83.44),
    ('IBM', 100, 45.23),
    ('GOOG', 75, 572.45),
    ('AA', 50, 23.15)
]
</code></pre>
<p>Hay dos entradas <code>'IBM'</code> y dos entradas <code>'GOOG'</code> en esta lista. Las
acciones deben combinarse de alguna manera.</p>
<h2 id="contadores">Contadores</h2>
<p>Solución: Utilice un <code>Counter</code>.</p>
<pre><code class="language-python">from collections import Counter
total_shares = Counter()
for name, shares, price in portfolio:
    total_shares[name] += shares

total_shares['IBM']     # 150
</code></pre>
<h2 id="ejemplo-asignaciones-de-uno-a-muchos">Ejemplo: Asignaciones de uno a muchos</h2>
<p>Problema: desea asignar una clave a múltiples valores.</p>
<pre><code class="language-python">portfolio = [
    ('GOOG', 100, 490.1),
    ('IBM', 50, 91.1),
    ('CAT', 150, 83.44),
    ('IBM', 100, 45.23),
    ('GOOG', 75, 572.45),
    ('AA', 50, 23.15)
]
</code></pre>
<p>Al igual que en el ejemplo anterior, la clave <code>'IBM'</code> debería tener dos
tuplas diferentes.</p>
<p>Solución: utilice un <code>defaultdict</code>.</p>
<pre><code class="language-python">from collections import defaultdict
holdings = defaultdict(list)
for name, shares, price in portfolio:
    holdings[name].append((shares, price))
holdings['IBM'] # [ (50, 91.1), (100, 45.23) ]
</code></pre>
<p><code>defaultdict</code> garantiza que cada vez que accedas a una clave obtendrás
un valor predeterminado.</p>
<h2 id="ejemplo-mantener-un-historial">Ejemplo: Mantener un historial</h2>
<p>Problema: Queremos un historial de las últimas N cosas. Solución:
utilice <code>deque</code>.</p>
<pre><code class="language-python">from collections import deque

history = deque(maxlen=N)
with open(filename) as f:
    for line in f:
        history.append(line)
        ...
</code></pre>
<ul>
<li>
<p>Abre un archivo cuyo nombre está en la variable <code>filename</code> para
    lectura.</p>
</li>
<li>
<p>Lee el archivo línea por línea.</p>
</li>
<li>
<p>Añade cada línea al deque llamado <code>history</code>.</p>
</li>
</ul>
<p>De esta manera, al finalizar, el deque <code>history</code> contendrá las últimas N
líneas del archivo. Si el archivo tiene menos de N líneas, contendrá
todas las líneas del archivo. Si tiene más de N líneas, solo contendrá
las últimas N líneas debido al límite máximo establecido.</p>
<h2 id="ejercicios">Ejercicios</h2>
<p>El módulo <code>collections</code> podría ser uno de los módulos de biblioteca más
útiles para tratar problemas de manejo de datos de propósitos
especiales, tales como tabulación e indexación.</p>
<p>En este ejercicio, veremos algunos ejemplos sencillos. Comience
ejecutando su programa <code>report.py</code> para que tenga la cartera de acciones
cargada en modo interactivo.</p>
<pre><code class="language-bash">bash % python -i report.py
</code></pre>
<h3 id="ejercicio-218-tabulacion-con-contadores">Ejercicio 2.18: Tabulación con contadores</h3>
<p>Supongamos que desea tabular la tenencia total de cada acción. Esto es
fácil usando objetos 'Counter'. Pruébalo:</p>
<pre><code class="language-python">&gt;&gt;&gt; portfolio = read_portfolio('Data/portfolio.csv')
&gt;&gt;&gt; from collections import Counter
&gt;&gt;&gt; holdings = Counter()
&gt;&gt;&gt; for s in portfolio:
        holdings[s['name']] += s['shares']

&gt;&gt;&gt; holdings
Counter({'MSFT': 250, 'IBM': 150, 'CAT': 150, 'AA': 100, 'GE': 95})
&gt;&gt;&gt;
</code></pre>
<p>Observe atentamente cómo las entradas múltiples para <code>'MSFT'</code> e <code>'IBM'</code>
en <code>portafolio</code> se combinan en una sola entrada aquí.</p>
<p>Puedes utilizar un contador como si fuera un diccionario para recuperar
valores individuales:</p>
<pre><code class="language-python">&gt;&gt;&gt; holdings['IBM']
150
&gt;&gt;&gt; holdings['MSFT']
250
&gt;&gt;&gt;
</code></pre>
<p>Si desea clasificar los valores, haga lo siguiente:</p>
<pre><code class="language-python">&gt;&gt;&gt; # Obtenga las tres acciones más importantes
&gt;&gt;&gt; holdings.most_common(3)
[('MSFT', 250), ('IBM', 150), ('CAT', 150)]
&gt;&gt;&gt;
</code></pre>
<p>Tomemos otra cartera de acciones y construyamos un nuevo contador:</p>
<pre><code class="language-python">&gt;&gt;&gt; portfolio2 = read_portfolio('Data/portfolio2.csv')
&gt;&gt;&gt; holdings2 = Counter()
&gt;&gt;&gt; for s in portfolio2:
          holdings2[s['name']] += s['shares']

&gt;&gt;&gt; holdings2
Counter({'HPQ': 250, 'GE': 125, 'AA': 50, 'MSFT': 25})
&gt;&gt;&gt;
</code></pre>
<p>Por último, combinemos todos los activos realizando una sencilla
operación:</p>
<pre><code class="language-python">&gt;&gt;&gt; holdings
Counter({'MSFT': 250, 'IBM': 150, 'CAT': 150, 'AA': 100, 'GE': 95})
&gt;&gt;&gt; holdings2
Counter({'HPQ': 250, 'GE': 125, 'AA': 50, 'MSFT': 25})
&gt;&gt;&gt; combined = holdings + holdings2
&gt;&gt;&gt; combined
Counter({'MSFT': 275, 'HPQ': 250, 'GE': 220, 'AA': 150, 'IBM': 150, 'CAT': 150})
&gt;&gt;&gt;
</code></pre>
<p>Esto es sólo una pequeña muestra de lo que los contadores ofrecen. Sin
embargo, si alguna vez necesitas tabular valores, deberías considerar
usar uno.</p>
<h2 id="comentario-modulo-collections">Comentario: módulo Collections</h2>
<p>El módulo <code>collections</code> es uno de los módulos de biblioteca más útiles
de todo Python. De hecho, podríamos hacer un tutorial extenso sólo sobre
eso. Sin embargo, hacerlo ahora también sería una distracción. Por
ahora, pon <code>collections</code> en tu lista de lectura para antes de dormir,
para más tarde.</p>
<p><a href="../../Contents/">Contenido</a> | <a href="../04_Sequences/">Anterior (2.4
Secuencias)</a> | <a href="../06_List_comprehension/">Próximo (2.6 Listas por
comprensión)</a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>