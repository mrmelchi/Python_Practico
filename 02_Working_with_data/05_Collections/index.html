<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Mario R. Melchiori">
        <link rel="canonical" href="https://mrmelchi.github.io/Python_Practico/02_Working_with_data/05_Collections/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>05_Collections - Python Practico</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Python Practico</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="../Contents.Rmd">Contenido</a> | <a href="04_Sequences.Rmd">Anterior (2.4
Secuencias)</a> | <a href="06_List_comprehension.Rmd">Siguiente (2.6 Listas por
comprensión)</a></p>
<h3 id="25-modulo-collections">2.5 Módulo collections</h3>
<p>El módulo <code>collections</code> proporciona una serie de objetos útiles para el
manejo de datos. En esta parte se presentan brevemente algunas de estas
características.</p>
<h4 id="ejemplo-contar-cosas">Ejemplo: Contar cosas</h4>
<p>Digamos que desea tabular el total de acciones de cada acción.</p>
<pre><code class="language-python">portfolio = [
    ('GOOG', 100, 490.1),
    ('IBM', 50, 91.1),
    ('CAT', 150, 83.44),
    ('IBM', 100, 45.23),
    ('GOOG', 75, 572.45),
    ('AA', 50, 23.15)
]
</code></pre>
<p>Hay dos entradas <code>'IBM'</code> y dos entradas <code>'GOOG'</code> en esta lista. Las
acciones deben combinarse de alguna manera.</p>
<h4 id="contadores">Contadores</h4>
<p>Solución: Utilice un <code>Counter</code>.</p>
<pre><code class="language-python">from collections import Counter
total_shares = Counter()
for name, shares, price in portfolio:
    total_shares[name] += shares

total_shares['IBM']     # 150
</code></pre>
<h4 id="ejemplo-asignaciones-de-uno-a-muchos">Ejemplo: Asignaciones de uno a muchos</h4>
<p>Problema: desea asignar una clave a múltiples valores.</p>
<pre><code class="language-python">portfolio = [
    ('GOOG', 100, 490.1),
    ('IBM', 50, 91.1),
    ('CAT', 150, 83.44),
    ('IBM', 100, 45.23),
    ('GOOG', 75, 572.45),
    ('AA', 50, 23.15)
]
</code></pre>
<p>Al igual que en el ejemplo anterior, la clave <code>'IBM'</code> debería tener dos
tuplas diferentes.</p>
<p>Solución: utilice un <code>defaultdict</code>.</p>
<pre><code class="language-python">from collections import defaultdict
holdings = defaultdict(list)
for name, shares, price in portfolio:
    holdings[name].append((shares, price))
holdings['IBM'] # [ (50, 91.1), (100, 45.23) ]
</code></pre>
<p><code>defaultdict</code> garantiza que cada vez que accedas a una clave obtendrás
un valor predeterminado.</p>
<h4 id="ejemplo-mantener-un-historial">Ejemplo: Mantener un historial</h4>
<p>Problema: Queremos un historial de las últimas N cosas. Solución:
utilice <code>deque</code>.</p>
<pre><code class="language-python">from collections import deque

history = deque(maxlen=N)
with open(filename) as f:
    for line in f:
        history.append(line)
        ...
</code></pre>
<h4 id="ejercicios">Ejercicios</h4>
<p>El módulo <code>collections</code> podría ser uno de los módulos de biblioteca más
útiles para tratar problemas de manejo de datos de propósitos
especiales, tales como tabulación e indexación.</p>
<p>En este ejercicio, veremos algunos ejemplos sencillos. Comience
ejecutando su programa <code>report.py</code> para que tenga la cartera de acciones
cargada en modo interactivo.</p>
<pre><code class="language-bash">bash % python3 -i report.py
</code></pre>
<h5 id="ejercicio-218-tabulacion-con-contadores">Ejercicio 2.18: Tabulación con contadores</h5>
<p>Supongamos que desea tabular la tenencia total de cada acción. Esto es
fácil usando objetos 'Counter'. Pruébalo:</p>
<pre><code class="language-python">&gt;&gt;&gt; portfolio = read_portfolio('Data/portfolio.csv')
&gt;&gt;&gt; from collections import Counter
&gt;&gt;&gt; holdings = Counter()
&gt;&gt;&gt; for s in portfolio:
        holdings[s['name']] += s['shares']

&gt;&gt;&gt; holdings
Counter({'MSFT': 250, 'IBM': 150, 'CAT': 150, 'AA': 100, 'GE': 95})
&gt;&gt;&gt;
</code></pre>
<p>Observe atentamente cómo las entradas múltiples para <code>'MSFT'</code> e <code>'IBM'</code>
en <code>portafolio</code> se combinan en una sola entrada aquí.</p>
<p>Puedes utilizar un contador como si fuera un diccionario para recuperar
valores individuales:</p>
<pre><code class="language-python">&gt;&gt;&gt; holdings['IBM']
150
&gt;&gt;&gt; holdings['MSFT']
250
&gt;&gt;&gt;
</code></pre>
<p>Si desea clasificar los valores, haga lo siguiente:</p>
<pre><code class="language-python">&gt;&gt;&gt; # Get three most held stocks
&gt;&gt;&gt; holdings.most_common(3)
[('MSFT', 250), ('IBM', 150), ('CAT', 150)]
&gt;&gt;&gt;
</code></pre>
<p>Tomemos otra cartera de acciones y creemos un nuevo contador:</p>
<pre><code class="language-python">&gt;&gt;&gt; portfolio2 = read_portfolio('Data/portfolio2.csv')
&gt;&gt;&gt; holdings2 = Counter()
&gt;&gt;&gt; for s in portfolio2:
          holdings2[s['name']] += s['shares']

&gt;&gt;&gt; holdings2
Counter({'HPQ': 250, 'GE': 125, 'AA': 50, 'MSFT': 25})
&gt;&gt;&gt;
</code></pre>
<p>Por último, combinemos todos los activos realizando una sencilla
operación:</p>
<pre><code class="language-python">&gt;&gt;&gt; holdings
Counter({'MSFT': 250, 'IBM': 150, 'CAT': 150, 'AA': 100, 'GE': 95})
&gt;&gt;&gt; holdings2
Counter({'HPQ': 250, 'GE': 125, 'AA': 50, 'MSFT': 25})
&gt;&gt;&gt; combined = holdings + holdings2
&gt;&gt;&gt; combined
Counter({'MSFT': 275, 'HPQ': 250, 'GE': 220, 'AA': 150, 'IBM': 150, 'CAT': 150})
&gt;&gt;&gt;
</code></pre>
<p>Esto es sólo una pequeña muestra de lo que los contadores ofrecen. Sin
embargo, si alguna vez necesitas tabular valores, deberías considerar
usar uno.</p>
<h5 id="comentario-modulo-collections">Comentario: módulo Collections</h5>
<p>El módulo <code>collections</code> es uno de los módulos de biblioteca más útiles
de todo Python. De hecho, podríamos hacer un tutorial extenso sólo sobre
eso. Sin embargo, hacerlo ahora también sería una distracción. Por
ahora, pon <code>collections</code> en tu lista de lectura para antes de dormir,
para más tarde.</p>
<p><a href="../Contents.Rmd">Contenido</a> | <a href="04_Sequences.Rmd">Anterior (2.4
Secuencias)</a> | <a href="06_List_comprehension.Rmd">Siguiente (2.6 Listas por
comprensión)</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
