<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Mario R. Melchiori">
        <link rel="canonical" href="https://mrmelchi.github.io/Python_Practico/03_Program_organization/06_Design_discussion/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>06_Design_discussion - Python Practico</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atelier-forest-light.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Python Practico</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#36-discusion-sobre-el-diseno" class="nav-link">3.6 Discusión sobre el diseño</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#nombres-de-archivo-versus-iterables" class="nav-link">Nombres de archivo versus iterables</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#idea-profunda-duck-typing" class="nav-link">Idea profunda: "Duck Typing"</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#mejores-practicas-de-diseno-de-bibliotecas" class="nav-link">Mejores prácticas de diseño de bibliotecas</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#ejercicio" class="nav-link">Ejercicio</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="../../Contents/">Contenido</a> | <a href="../05_Main_module/">Anterior (3.5 Módulo principal)</a> | <a href="../../04_Classes_objects/00_Overview/">Próximo (4. Clases y Objetos)</a></p>
<h1 id="36-discusion-sobre-el-diseno">3.6 Discusión sobre el diseño</h1>
<p>En esta sección reconsideramos una decisión de diseño tomada anteriormente.</p>
<h2 id="nombres-de-archivo-versus-iterables">Nombres de archivo versus iterables</h2>
<p>Compare estos dos programas que devuelven el mismo resultado.</p>
<pre><code class="language-python"># Proporcione un nombre de archivo
def read_data(filename):
    records = []
    with open(filename) as f:
        for line in f:
            ...
            records.append(r)
    return records

d = read_data('file.csv')
</code></pre>
<pre><code class="language-python"># Proporcione líneas
def read_data(lines):
    records = []
    for line in lines:
        ...
        records.append(r)
    return records

with open('file.csv') as f:
    d = read_data(f)
</code></pre>
<ul>
<li>¿Cuál de estas funciones prefiere? ¿Por qué?</li>
<li>¿Cuál de estas funciones es más flexible?</li>
</ul>
<h2 id="idea-profunda-duck-typing">Idea profunda: "Duck Typing"</h2>
<p><a href="https://en.wikipedia.org/wiki/Duck_typing">Duck Typing</a> es un concepto de programación informática para determinar si un objeto se puede usar para un propósito particular. Es una aplicación de la <a href="https://en.wikipedia.org/wiki/Duck_test">prueba del pato</a>.</p>
<blockquote>
<p>Si parece un pato, nada como un pato y grazna como un pato, entonces probablemente sea un pato.</p>
</blockquote>
<p>En la segunda versión de <code>read_data()</code> anterior, la función espera cualquier objeto iterable. No solo las líneas de un archivo.</p>
<pre><code class="language-python">def read_data(lines):
    records = []
    for line in lines:
        ...
        records.append(r)
    return records
</code></pre>
<p>Esto significa que podemos usarlo con otras <em>líneas</em>.</p>
<pre><code class="language-python"># Un archivo CSV
lines = open('data.csv')
data = read_data(lines)

# Un archivo comprimido
lines = gzip.open('data.csv.gz','rt')
data = read_data(lines)

# La entrada estándar
lines = sys.stdin
data = read_data(lines)

# Una lista de cadenas
lines = ['ACME,50,91.1','IBM,75,123.45', ... ]
data = read_data(lines)
</code></pre>
<p>Este diseño ofrece una flexibilidad considerable.</p>
<p><em>Pregunta: ¿Deberíamos adoptar o luchar contra esta flexibilidad?</em></p>
<h2 id="mejores-practicas-de-diseno-de-bibliotecas">Mejores prácticas de diseño de bibliotecas</h2>
<p>Las bibliotecas de código suelen funcionar mejor si adoptan la flexibilidad. No restrinja sus opciones. Una gran flexibilidad conlleva un gran poder.</p>
<h2 id="ejercicio">Ejercicio</h2>
<h3 id="ejercicio-317-de-nombres-de-archivo-a-objetos-similares-a-archivos">Ejercicio 3.17: De nombres de archivo a objetos similares a archivos</h3>
<p>Ahora ha creado un archivo <code>fileparse.py</code> que contenía una función <code>parse_csv()</code>. La función funcionaba de la siguiente manera:</p>
<pre><code class="language-python">&gt;&gt;&gt; import fileparse
&gt;&gt;&gt; portfolio = fileparse.parse_csv('Data/portfolio.csv', types=[str,int,float])
&gt;&gt;&gt;
</code></pre>
<p>En este momento, la función espera que se le pase un nombre de archivo. Sin embargo, puede hacer que el código sea más flexible. Modifique la función para que funcione con cualquier objeto iterable o similar a un archivo. Por ejemplo:</p>
<pre><code class="language-python">&gt;&gt;&gt; import fileparse
&gt;&gt;&gt; import gzip
&gt;&gt;&gt; with gzip.open('Data/portfolio.csv.gz', 'rt') as file:
...      port = fileparse.parse_csv(file, types=[str,int,float])
...
&gt;&gt;&gt; lines = ['name,shares,price', 'AA,100,34.23', 'IBM,50,91.1', 'HPE,75,45.1']
&gt;&gt;&gt; port = fileparse.parse_csv(lines, types=[str,int,float])
&gt;&gt;&gt;
</code></pre>
<p>En este nuevo código, ¿qué sucede si pasa un nombre de archivo como antes?</p>
<pre><code>&gt;&gt;&gt; port = fileparse.parse_csv('Data/portfolio.csv', types=[str,int,float])
&gt;&gt;&gt; port
... mira la salida (debería ser una locura) ...
&gt;&gt;&gt;
</code></pre>
<p>Sí, tendrás que tener cuidado. ¿Podrías agregar una comprobación de seguridad para evitar esto?</p>
<h3 id="ejercicio-318-corregir-funciones-existentes">Ejercicio 3.18: Corregir funciones existentes</h3>
<p>Corrige las funciones <code>read_portfolio()</code> y <code>read_prices()</code> en el archivo <code>report.py</code> para que funcionen con la versión modificada de <code>parse_csv()</code>. Esto solo debería implicar una modificación menor. Después, tus programas <code>report.py</code> y <code>pcost.py</code> deberían funcionar de la misma manera que siempre lo hicieron.</p>
<p><a href="../../Contents/">Contenido</a> | <a href="../05_Main_module/">Anterior (3.5 Módulo principal)</a> | <a href="../../04_Classes_objects/00_Overview/">Próximo (4. Clases y Objetos)</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
