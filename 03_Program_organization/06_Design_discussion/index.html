
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Mario R. Melchiori">
      
      
        <link rel="canonical" href="https://mrmelchi.github.io/Python_Practico/03_Program_organization/06_Design_discussion/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>06_Design_discussion - Python Practico</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#36-discusion-sobre-el-diseno" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Python Practico" class="md-header__button md-logo" aria-label="Python Practico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Python Practico
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              06_Design_discussion
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Python Practico" class="md-nav__button md-logo" aria-label="Python Practico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Python Practico
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nombres-de-archivo-versus-iterables" class="md-nav__link">
    <span class="md-ellipsis">
      Nombres de archivo versus iterables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#idea-profunda-duck-typing" class="md-nav__link">
    <span class="md-ellipsis">
      Idea profunda: "Duck Typing"
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mejores-practicas-de-diseno-de-bibliotecas" class="md-nav__link">
    <span class="md-ellipsis">
      Mejores prácticas de diseño de bibliotecas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicio" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ejercicio">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-317-de-nombres-de-archivo-a-objetos-similares-a-archivos" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 3.17: De nombres de archivo a objetos similares a archivos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-318-corregir-funciones-existentes" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 3.18: Corregir funciones existentes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p><a href="../../Contents/">Contenido</a> | <a href="../05_Main_module/">Anterior (3.5 Módulo principal)</a> | <a href="../../04_Classes_objects/00_Overview/">Próximo (4. Clases y Objetos)</a></p>
<h1 id="36-discusion-sobre-el-diseno">3.6 Discusión sobre el diseño</h1>
<p>En esta sección reconsideramos una decisión de diseño tomada anteriormente.</p>
<h2 id="nombres-de-archivo-versus-iterables">Nombres de archivo versus iterables</h2>
<p>Compare estos dos programas que devuelven el mismo resultado.</p>
<pre><code class="language-python"># Proporcione un nombre de archivo
def read_data(filename):
    records = []
    with open(filename) as f:
        for line in f:
            ...
            records.append(r)
    return records

d = read_data('file.csv')
</code></pre>
<pre><code class="language-python"># Proporcione líneas
def read_data(lines):
    records = []
    for line in lines:
        ...
        records.append(r)
    return records

with open('file.csv') as f:
    d = read_data(f)
</code></pre>
<ul>
<li>¿Cuál de estas funciones prefiere? ¿Por qué?</li>
<li>¿Cuál de estas funciones es más flexible?</li>
</ul>
<h2 id="idea-profunda-duck-typing">Idea profunda: "Duck Typing"</h2>
<p><a href="https://en.wikipedia.org/wiki/Duck_typing">Duck Typing</a> es un concepto de programación informática para determinar si un objeto se puede usar para un propósito particular. Es una aplicación de la [prueba del pato] <a href="https://en.wikipedia.org/wiki/Duck_test">https://en.wikipedia.org/wiki/Duck_test</a>).</p>
<blockquote>
<p>Si parece un pato, nada como un pato y grazna como un pato, entonces probablemente sea un pato.</p>
</blockquote>
<p>En la segunda versión de <code>read_data()</code> anterior, la función espera cualquier objeto iterable. No solo las líneas de un archivo.</p>
<pre><code class="language-python">def read_data(lines):
    records = []
    for line in lines:
        ...
        records.append(r)
    return records
</code></pre>
<p>Esto significa que podemos usarlo con otras <em>líneas</em>.</p>
<pre><code class="language-python"># Un archivo CSV
lines = open('data.csv')
data = read_data(lines)

# Un archivo comprimido
lines = gzip.open('data.csv.gz','rt')
data = read_data(lines)

# La entrada estándar
lines = sys.stdin
data = read_data(lines)

# Una lista de cadenas
lines = ['ACME,50,91.1','IBM,75,123.45', ... ]
data = read_data(lines)
</code></pre>
<p>Este diseño ofrece una flexibilidad considerable.</p>
<p><em>Pregunta: ¿Deberíamos adoptar o luchar contra esta flexibilidad?</em></p>
<h2 id="mejores-practicas-de-diseno-de-bibliotecas">Mejores prácticas de diseño de bibliotecas</h2>
<p>Las bibliotecas de código suelen funcionar mejor si adoptan la flexibilidad. No restrinja sus opciones. Una gran flexibilidad conlleva un gran poder.</p>
<h2 id="ejercicio">Ejercicio</h2>
<h3 id="ejercicio-317-de-nombres-de-archivo-a-objetos-similares-a-archivos">Ejercicio 3.17: De nombres de archivo a objetos similares a archivos</h3>
<p>Ahora ha creado un archivo <code>fileparse.py</code> que contenía una función <code>parse_csv()</code>. La función funcionaba de la siguiente manera:</p>
<pre><code class="language-python">&gt;&gt;&gt; import fileparse
&gt;&gt;&gt; portfolio = fileparse.parse_csv('Data/portfolio.csv', types=str,int,float])
&gt;&gt;&gt;
</code></pre>
<p>En este momento, la función espera que se le pase un nombre de archivo. Sin embargo, puede hacer que el código sea más flexible. Modifique la función para que funcione con cualquier objeto iterable o similar a un archivo. Por ejemplo:</p>
<pre><code class="language-python">&gt;&gt;&gt; import fileparse
&gt;&gt;&gt; import gzip
&gt;&gt;&gt; with gzip.open('Data/portfolio.csv.gz', 'rt') as file:
...      port = fileparse.parse_csv(file, types=[str,int,float])
...
&gt;&gt;&gt; lines = ['name,shares,price', 'AA,100,34.23', 'IBM,50,91.1', 'HPE,75,45.1']
&gt;&gt;&gt; port = fileparse.parse_csv(lines, types=[str,int,float])
&gt;&gt;&gt;
</code></pre>
<p>En este nuevo código, ¿qué sucede si pasa un nombre de archivo como antes?</p>
<pre><code>&gt;&gt;&gt; port = fileparse.parse_csv('Data/portfolio.csv', types=[str,int,float])
&gt;&gt;&gt; port
... mira la salida (debería ser una locura) ...
&gt;&gt;&gt;
</code></pre>
<p>Sí, tendrás que tener cuidado. ¿Podrías agregar una comprobación de seguridad para evitar esto?</p>
<h3 id="ejercicio-318-corregir-funciones-existentes">Ejercicio 3.18: Corregir funciones existentes</h3>
<p>Corrige las funciones <code>read_portfolio()</code> y <code>read_prices()</code> en el archivo <code>report.py</code> para que funcionen con la versión modificada de <code>parse_csv()</code>. Esto solo debería implicar una modificación menor. Después, tus programas <code>report.py</code> y <code>pcost.py</code> deberían funcionar de la misma manera que siempre lo hicieron.</p>
<p><a href="../../Contents/">Contenido</a> | <a href="../05_Main_module/">Anterior (3.5 Módulo principal)</a> | <a href="../../04_Classes_objects/00_Overview/">Próximo (4. Clases y Objetos)</a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>